Задание по разработке ETL процесса, получающего ежедневную выгрузку данных, 
загружающего ее в хранилище данных, и строящий ежедневно отчет.

Ежедневно некие информационные системы выгружают следующие файлы:
Список транзакций за текущий день. Формат – CSV.
Список терминалов полным срезом. Формат – XLSX.
Список паспортов, включенных в «черный список» - с накоплением с 
начала месяца. Формат – XLSX.
Сведения о картах, счетах и клиентах хранятся в СУБД Oracle в схеме BANK. 
Вам предоставляется выгрузка за последние три дня, ее надо обработать. 

Типы данных в полях можно изменять на однородные если для этого есть 
необходимость. Имена полей менять нельзя. Ко всем таблицам SCD1 
должны быть 
добавлены технические поля create_dt, update_dt; ко всем таблицам SCD2 
должны быть добавлены технические поля effective_from, effective_to, 
deleted_flg.

По результатам загрузки ежедневно необходимо строить витрину 
отчетности по мошенническим операциям. Витрина строится 
накоплением, 
каждый новый отчет укладывается в эту же таблицу с новым report_dt. 

В витрине должны содержаться следующие поля:

event_dt 
Время наступления события. Если событие наступило по 
результату нескольких действий – указывается время действия, 
по которому установлен факт мошенничества.

passport 
Номер паспорта клиента, совершившего мошенническую 
операцию.

fio 
ФИО клиента, совершившего мошенническую операцию.

phone 
Номер телефона клиента, совершившего мошенническую 
операцию.

event_type 
Описание типа мошенничества.

report_dt 
Время построения отчета.


Признаки мошеннических операций.
Совершение операции при просроченном или заблокированном 
паспорте.
Совершение операции при недействующем договоре.
Совершение операций в разных городах в течение одного часа.
Попытка подбора суммы. В течение 20 минут проходит более 3х 
операций 
со следующим шаблоном – каждая последующая меньше предыдущей, 
при этом 
отклонены все кроме последней. Последняя операция (успешная) в 
такой цепочке считается мошеннической.

Выгружаемые файлы именуются согласно следующему шаблону:
transactions_DDMMYYYY.txt
passport_blacklist_DDMMYYYY.xlsx
terminals_DDMMYYYY.xlsx

Предполагается что в один день приходит по одному такому файлу. После 
загрузки соответствующего файла он должен быть переименован в файл с 
расширением .backup чтобы при следующем запуске файл не искался и 
перемещен в каталог archive:
transactions_DDMMYYYY.txt.backup
passport_blacklist_DDMMYYYY.xlsx.backup
terminals_DDMMYYYY.xlsx.backup
